EESchema Schematic File Version 2
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:linearsource_mod-cache
EELAYER 25 0
EELAYER END
$Descr User 7874 5906
encoding utf-8
Sheet 1 1
Title "Linear currentsource"
Date "2016-04-16"
Rev "0.2"
Comp "Jon Nordby http://jonnor.com"
Comment1 "Project: https://github.com/jonnor/projects/tree/master/currentsource"
Comment2 "Open Source Hardware under MIT license"
Comment3 ""
Comment4 ""
$EndDescr
$Comp
L LM358 U1
U 1 1 5711412E
P 2500 3600
F 0 "U1" H 2450 3800 50  0000 L CNN
F 1 "LM358" H 2450 3350 50  0000 L CNN
F 2 "SMD_Packages:SOIC-8-N" H 2500 3600 50  0001 C CNN
F 3 "" H 2500 3600 50  0000 C CNN
	1    2500 3600
	1    0    0    -1  
$EndComp
$Comp
L LM358 U1
U 2 1 571141CE
P 3950 2600
F 0 "U1" H 3900 2800 50  0000 L CNN
F 1 "LM358" H 3900 2350 50  0000 L CNN
F 2 "SMD_Packages:SOIC-8-N" H 3950 2600 50  0001 C CNN
F 3 "" H 3950 2600 50  0000 C CNN
	2    3950 2600
	1    0    0    -1  
$EndComp
$Comp
L Q_NMOS_DGS Q1
U 1 1 57114293
P 5050 2600
F 0 "Q1" H 5350 2650 50  0000 R CNN
F 1 "PSMN017-30BL" H 5850 2550 50  0000 R CNN
F 2 "TO_SOT_Packages_SMD:TO-263-3Lead" H 5250 2700 50  0001 C CNN
F 3 "" H 5050 2600 50  0000 C CNN
	1    5050 2600
	1    0    0    -1  
$EndComp
$Comp
L R R5
U 1 1 5711479C
P 5150 3100
F 0 "R5" V 5230 3100 50  0000 C CNN
F 1 "0.1" V 5150 3100 50  0000 C CNN
F 2 "Resistors_SMD:R_2512" V 5080 3100 50  0001 C CNN
F 3 "" H 5150 3100 50  0000 C CNN
	1    5150 3100
	1    0    0    -1  
$EndComp
$Comp
L R R4
U 1 1 571147FF
P 4550 2600
F 0 "R4" V 4630 2600 50  0000 C CNN
F 1 "120" V 4550 2600 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 4480 2600 50  0001 C CNN
F 3 "" H 4550 2600 50  0000 C CNN
	1    4550 2600
	0    1    1    0   
$EndComp
$Comp
L R R3
U 1 1 571148F8
P 2450 4100
F 0 "R3" V 2530 4100 50  0000 C CNN
F 1 "100k" V 2450 4100 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 2380 4100 50  0001 C CNN
F 3 "" H 2450 4100 50  0000 C CNN
	1    2450 4100
	0    1    1    0   
$EndComp
$Comp
L R R2
U 1 1 57114971
P 2000 3950
F 0 "R2" V 2080 3950 50  0000 C CNN
F 1 "10k" V 2000 3950 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1930 3950 50  0001 C CNN
F 3 "" H 2000 3950 50  0000 C CNN
	1    2000 3950
	1    0    0    -1  
$EndComp
$Comp
L R R1
U 1 1 57114A48
P 1800 3950
F 0 "R1" V 1880 3950 50  0000 C CNN
F 1 "12k" V 1800 3950 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1730 3950 50  0001 C CNN
F 3 "" H 1800 3950 50  0000 C CNN
	1    1800 3950
	1    0    0    -1  
$EndComp
Wire Wire Line
	2600 4100 2900 4100
Wire Wire Line
	2900 4100 2900 3600
Wire Wire Line
	2000 3700 2200 3700
Wire Wire Line
	2000 3700 2000 3800
Wire Wire Line
	2300 4100 2150 4100
Wire Wire Line
	2150 4100 2150 3700
Connection ~ 2150 3700
Wire Wire Line
	3850 2900 3850 3100
$Comp
L VCC #PWR01
U 1 1 57114BAF
P 3850 1600
F 0 "#PWR01" H 3850 1450 50  0001 C CNN
F 1 "VCC" H 3850 1750 50  0000 C CNN
F 2 "" H 3850 1600 50  0000 C CNN
F 3 "" H 3850 1600 50  0000 C CNN
	1    3850 1600
	1    0    0    -1  
$EndComp
Wire Wire Line
	3850 1600 3850 2300
Wire Wire Line
	4700 2600 4850 2600
Wire Wire Line
	5150 2800 5150 2950
Wire Wire Line
	5150 3250 5150 3450
Connection ~ 5150 2850
Wire Wire Line
	2000 4100 2000 4350
Wire Wire Line
	1800 3800 1800 3500
Wire Wire Line
	1700 3500 2200 3500
Wire Wire Line
	1800 4100 1800 4200
Wire Wire Line
	1800 4200 2000 4200
Connection ~ 2000 4200
Text GLabel 5050 2850 0    60   BiDi ~ 0
I_sense
Wire Wire Line
	5050 2850 5150 2850
Text GLabel 1700 3500 0    60   BiDi ~ 0
I_sense
Connection ~ 1800 3500
Connection ~ 2900 3600
Wire Wire Line
	5150 2150 5150 2400
Wire Wire Line
	4250 2600 4400 2600
Wire Wire Line
	2800 3600 3000 3600
$Comp
L R R6
U 1 1 57115B1C
P 3150 3600
F 0 "R6" V 3230 3600 50  0000 C CNN
F 1 "10k" V 3150 3600 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 3080 3600 50  0001 C CNN
F 3 "" H 3150 3600 50  0000 C CNN
	1    3150 3600
	0    1    1    0   
$EndComp
Wire Wire Line
	3450 2700 3450 3600
Wire Wire Line
	3450 2700 3650 2700
$Comp
L GNDPWR #PWR02
U 1 1 57115ECA
P 5150 3450
F 0 "#PWR02" H 5150 3250 50  0001 C CNN
F 1 "GNDPWR" H 5150 3320 50  0000 C CNN
F 2 "" H 5150 3400 50  0000 C CNN
F 3 "" H 5150 3400 50  0000 C CNN
	1    5150 3450
	1    0    0    -1  
$EndComp
$Comp
L CONN_01X04 P1
U 1 1 57115F44
P 1550 1000
F 0 "P1" H 1550 1250 50  0000 C CNN
F 1 "CONN_01X04" V 1650 1000 50  0000 C CNN
F 2 "Pin_Headers:Pin_Header_Straight_1x04" H 1550 1000 50  0001 C CNN
F 3 "" H 1550 1000 50  0000 C CNN
	1    1550 1000
	1    0    0    -1  
$EndComp
Text GLabel 1200 850  0    60   Input ~ 0
VCC
Text GLabel 1200 950  0    60   Input ~ 0
PWM
Text GLabel 1200 1050 0    60   Input ~ 0
GND
Text GLabel 1200 1150 0    60   Input ~ 0
I_set
$Comp
L CONN_01X04 P2
U 1 1 571160BF
P 5100 1000
F 0 "P2" H 5100 1250 50  0000 C CNN
F 1 "CONN_01X04" V 5200 1000 50  0000 C CNN
F 2 "Pin_Headers:Pin_Header_Straight_1x04" H 5100 1000 50  0001 C CNN
F 3 "" H 5100 1000 50  0000 C CNN
	1    5100 1000
	-1   0    0    -1  
$EndComp
Text GLabel 5450 850  2    60   Input ~ 0
GNDPWR
Text GLabel 5450 950  2    60   Input ~ 0
V+
Text GLabel 5450 1050 2    60   Output ~ 0
I_out+
Text GLabel 5450 1150 2    60   Output ~ 0
I_out-
Text GLabel 5300 2150 2    60   Output ~ 0
I_out-
Text GLabel 5300 1850 2    60   Output ~ 0
I_out+
Text GLabel 4950 1850 0    60   Input ~ 0
V+
Wire Wire Line
	5450 1150 5300 1150
Wire Wire Line
	5450 1050 5300 1050
Wire Wire Line
	5450 950  5300 950 
Wire Wire Line
	5450 850  5300 850 
Wire Wire Line
	1200 850  1350 850 
Wire Wire Line
	1200 950  1350 950 
Wire Wire Line
	1200 1050 1350 1050
Wire Wire Line
	1200 1150 1350 1150
$Comp
L C C1
U 1 1 5711663E
P 4100 1900
F 0 "C1" H 4125 2000 50  0000 L CNN
F 1 "1uF" H 4125 1800 50  0000 L CNN
F 2 "Capacitors_SMD:C_1206" H 4138 1750 50  0001 C CNN
F 3 "" H 4100 1900 50  0000 C CNN
	1    4100 1900
	1    0    0    -1  
$EndComp
Wire Wire Line
	4100 1700 4100 1750
Wire Wire Line
	4100 2050 4100 2100
$Comp
L GND #PWR03
U 1 1 5711682B
P 2850 3000
F 0 "#PWR03" H 2850 2750 50  0001 C CNN
F 1 "GND" H 2850 2850 50  0000 C CNN
F 2 "" H 2850 3000 50  0000 C CNN
F 3 "" H 2850 3000 50  0000 C CNN
	1    2850 3000
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR04
U 1 1 571168BC
P 2000 4350
F 0 "#PWR04" H 2000 4100 50  0001 C CNN
F 1 "GND" H 2000 4200 50  0000 C CNN
F 2 "" H 2000 4350 50  0000 C CNN
F 3 "" H 2000 4350 50  0000 C CNN
	1    2000 4350
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR05
U 1 1 57116905
P 3850 3100
F 0 "#PWR05" H 3850 2850 50  0001 C CNN
F 1 "GND" H 3850 2950 50  0000 C CNN
F 2 "" H 3850 3100 50  0000 C CNN
F 3 "" H 3850 3100 50  0000 C CNN
	1    3850 3100
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR06
U 1 1 5711694E
P 4100 2100
F 0 "#PWR06" H 4100 1850 50  0001 C CNN
F 1 "GND" H 4100 1950 50  0000 C CNN
F 2 "" H 4100 2100 50  0000 C CNN
F 3 "" H 4100 2100 50  0000 C CNN
	1    4100 2100
	1    0    0    -1  
$EndComp
$Comp
L BC849 Q2
U 1 1 57116A5F
P 2750 2650
F 0 "Q2" H 2950 2725 50  0000 L CNN
F 1 "BC849" H 2950 2650 50  0000 L CNN
F 2 "TO_SOT_Packages_SMD:SOT-323" H 2950 2575 50  0001 L CIN
F 3 "" H 2750 2650 50  0000 L CNN
	1    2750 2650
	1    0    0    -1  
$EndComp
$Comp
L R R9
U 1 1 57116A96
P 2850 2250
F 0 "R9" V 2930 2250 50  0000 C CNN
F 1 "100" V 2850 2250 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 2780 2250 50  0001 C CNN
F 3 "" H 2850 2250 50  0000 C CNN
	1    2850 2250
	1    0    0    -1  
$EndComp
$Comp
L R R7
U 1 1 57116BC8
P 1950 2650
F 0 "R7" V 2030 2650 50  0000 C CNN
F 1 "1k" V 1950 2650 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1880 2650 50  0001 C CNN
F 3 "" H 1950 2650 50  0000 C CNN
	1    1950 2650
	0    1    1    0   
$EndComp
Wire Wire Line
	2850 2850 2850 3000
Wire Wire Line
	2850 2450 2850 2400
Wire Wire Line
	2100 2650 2550 2650
Wire Wire Line
	3350 2500 3650 2500
Wire Wire Line
	2100 2000 2400 2000
Wire Wire Line
	2700 2000 3350 2000
Wire Wire Line
	3350 2000 3350 2500
Wire Wire Line
	2850 2000 2850 2100
$Comp
L C C2
U 1 1 5711798C
P 2250 2250
F 0 "C2" H 2275 2350 50  0000 L CNN
F 1 "1uF" H 2275 2150 50  0000 L CNN
F 2 "Capacitors_SMD:C_1206" H 2288 2100 50  0001 C CNN
F 3 "" H 2250 2250 50  0000 C CNN
	1    2250 2250
	1    0    0    -1  
$EndComp
$Comp
L R R8
U 1 1 57117AB3
P 1950 2000
F 0 "R8" V 2030 2000 50  0000 C CNN
F 1 "100k" V 1950 2000 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1880 2000 50  0001 C CNN
F 3 "" H 1950 2000 50  0000 C CNN
	1    1950 2000
	0    1    1    0   
$EndComp
Wire Wire Line
	2250 2000 2250 2100
Connection ~ 2250 2000
Connection ~ 2850 2000
Text GLabel 1600 2000 0    60   Input ~ 0
I_set
Wire Wire Line
	1600 2000 1800 2000
Wire Wire Line
	2250 2400 2250 2950
Wire Wire Line
	2250 2950 2850 2950
Connection ~ 2850 2950
Text GLabel 1600 2650 0    60   Input ~ 0
PWM
Wire Wire Line
	1600 2650 1800 2650
Wire Wire Line
	3450 3600 3300 3600
Text Label 3350 2000 0    60   ~ 0
I_target
Text Label 3450 3600 0    60   ~ 0
I_feedback
Connection ~ 3450 3600
Connection ~ 3350 2000
Wire Wire Line
	5300 2150 5150 2150
Wire Wire Line
	4950 1850 5300 1850
Wire Wire Line
	4100 1700 3850 1700
Connection ~ 3850 1700
Text GLabel 800  5050 0    60   Input ~ 0
VCC
Text GLabel 800  5200 0    60   Input ~ 0
GND
Text GLabel 1000 5350 0    60   Input ~ 0
GNDPWR
$Comp
L PWR_FLAG #FLG07
U 1 1 5711AB1A
P 1100 5050
F 0 "#FLG07" H 1100 5145 50  0001 C CNN
F 1 "PWR_FLAG" H 1100 5230 50  0000 C CNN
F 2 "" H 1100 5050 50  0000 C CNN
F 3 "" H 1100 5050 50  0000 C CNN
	1    1100 5050
	1    0    0    -1  
$EndComp
$Comp
L PWR_FLAG #FLG08
U 1 1 5711AB5F
P 1500 5050
F 0 "#FLG08" H 1500 5145 50  0001 C CNN
F 1 "PWR_FLAG" H 1500 5230 50  0000 C CNN
F 2 "" H 1500 5050 50  0000 C CNN
F 3 "" H 1500 5050 50  0000 C CNN
	1    1500 5050
	1    0    0    -1  
$EndComp
Wire Wire Line
	1100 5050 800  5050
Wire Wire Line
	1500 5200 1500 5050
Wire Wire Line
	800  5200 1500 5200
Wire Wire Line
	1000 5350 1200 5350
Wire Wire Line
	1200 5350 1200 5200
Connection ~ 1200 5200
$Comp
L R R?
U 1 1 59871E1C
P 2550 2000
F 0 "R?" V 2630 2000 50  0000 C CNN
F 1 "100k" V 2550 2000 50  0000 C CNN
F 2 "" V 2480 2000 50  0001 C CNN
F 3 "" H 2550 2000 50  0001 C CNN
	1    2550 2000
	0    1    1    0   
$EndComp
$EndSCHEMATC
